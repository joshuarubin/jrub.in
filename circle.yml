machine:
  environment:
    HUGO_VERSION: "0.14"

dependencies:
  cache_directories:
    - ~/bin
  override:
    - |
      if [[ ! -e ~/bin/hugo ]]; then
        wget https://github.com/spf13/hugo/releases/download/v${HUGO_VERSION}/hugo_${HUGO_VERSION}_linux_amd64.tar.gz
        tar xzf hugo_${HUGO_VERSION}_linux_amd64.tar.gz
        cp hugo_${HUGO_VERSION}_linux_amd64/hugo_${HUGO_VERSION}_linux_amd64 ~/bin/hugo
      fi

test:
  override:
    - hugo --verbose

deployment:
  gh_pages:
    branch: master
    commands:
      - git subtree push --prefix=public git@github.com:joshuarubin/jrub.in.git gh-pages
